<div class="container pb-2 border-bottom">
  <!--投稿内容-->
  <div class="d-flex align-items-center mt-2">
      <div class="col-md-1 px-0">
        <!--管理者とメンバーで遷移先を変える-->
        <% if admin_signed_in? %>
          <%= link_to admin_member_path(member.id) do %>
            <%= image_tag member.get_profile_image(60,60) %>
          <% end %>
        <% else %>
          <%= link_to member_path(member.id) do %>
            <%= image_tag member.get_profile_image(60,60) %>
          <% end %>
        <% end %>
      </div>
    <div class="col-md-6">
      <% if admin_signed_in? %>
        <%= link_to member.name, admin_member_path(member.id),class: "text-body" %>
      <% else %>
        <%= link_to member.name, member_path(member.id),class: "text-body" %>
      <% end %>
    </div>
    <!--いいねボタン-->
    <div class="col-md-5 text-right">
      <span id ="empathy_counts<%= post.id %>" >
        <%= render "member/empathies/empathy_link", post: post, empathies: empathies %>
      </span>
      <i class="fas fa-comment ml-3 text-secondary"></i><span class ="text-secondary"><%= comments.count %></span>
    </div>
  </div>

  <div class="row">
    <div class="col-md text-break">
      <%= post.title %>
    </div>
  </div>


  <div class="row">
    <div class="col-md text-break">
      <%= simple_format(post.body) %>
    </div>
  </div>

  <div class="row justify-content-between">
  <div class = "col-md-6">
    カテゴリー:<%= post.category.name %>
    <% if post.genre.present? %>
      ジャンル:<%= post.genre.name %>
    <% end %>
  </div>
    <div class="col-md-4 md-text-right">
      <% if admin_signed_in? %>
        <%= post.closed_check %>
        <%= link_to "削除", admin_post_path(post.id), method: :delete,data: {confirm: "投稿を削除しますか？"} %>
      <% elsif post.member == current_member %>
      <% post.is_closed? %>
        <% if post.is_closed %>
          <%= link_to "トーク中にもどす", post_path(post.id, post: {is_closed: false}),method: :patch,class: "text-body"  %>
        <% else %>
          <%= link_to "トークを終了する", post_path(post.id, post: {is_closed: true}),method: :patch,class: "text-body"  %>
        <% end %>
        <%= link_to "削除", post_path(post.id), method: :delete,data: {confirm: "投稿を削除しますか？"},class: "text-danger"  %>
      <% else %>
      <%= post.closed_check %>
      <% end %>
    </div>
  </div>
</div>
<!--コメント一覧-->
<div class="container", style="ppading-bottom:50px;">
  <% comments.each do |comment| %>
    <div class="row mt-3 ml-5">

      <div class="col-md-9">
        <%= link_to member_path(member.id ),class: "text-body" do %>
          <%= image_tag comment.member.get_profile_image(30,30) %>
          <%= comment.member.name %>
        <% end %>

        <% if admin_signed_in? %>
          <%= link_to admin_post_comment_path(post.id,comment.id),method: :delete,class: "btn", data: {confirm: "コメントを削除しますか？"} do %>
            <i class="far fa-trash-alt"></i>
          <% end %>
        <% elsif comment.member_id == current_member.id %>
          <%= link_to post_comment_path(post.id,comment.id),method: :delete,class: "btn", data: {confirm: "コメントを削除しますか？"} do %>
          <i class="far fa-trash-alt"></i>
          <% end %>
        <% end %>
      </div>

      <div class="col-md-9 text-break">
        <%= simple_format(comment.body) %>
      </div>

    </div>
  <% end %>
</div>

<div class="container form-design">
  <% if post.is_closed == false %>
    <%= form_with model: comment,url: post_comments_path(post.id),method: :post do |f| %>
      <div class="row justify-content-center fixed-bottom">

        <div class="col-md-8 form-group ml-sm-0 ml-xs-0 pr-0">
          <%= flash[:comment_create_alret] %>
          <%= f.text_area :body, class: "form-control" %>
        </div>

        <div class="d-flex col-md-1 align-items-center">
          <%= f.submit "送信",class: "btn btn-sm btn-outline-dark" %>
        </div>

      </div>
    <% end %>
  <% end %>
</div>
